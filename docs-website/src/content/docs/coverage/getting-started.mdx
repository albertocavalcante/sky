---
title: Coverage - Getting Started
description: Collect code coverage for Starlark files
---

import { Tabs, TabItem, Code } from '@astrojs/starlight/components';

# Code Coverage for Starlark

Sky provides code coverage collection for Starlark files through `skytest` and `skycov`.

## Quick Start

```bash
# Run tests with coverage collection
skytest --coverage tests/

# View coverage report
skycov coverage.json
```

## How It Works

Coverage collection uses the `OnExec` hook in [starlark-go-x](/sky/starlark-go-x/onexec-hook/) to track which lines are executed during test runs.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Your .star files   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  skytest --coverage â”‚  â† OnExec hook fires for each instruction
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   coverage.json     â”‚  â† Raw coverage data
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       skycov        â”‚  â† Format and report
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example

Create a test file:

```starlark title="math_test.star"
def add(a, b):
    return a + b

def test_add():
    assert.eq(add(1, 2), 3)
    assert.eq(add(0, 0), 0)
```

Run with coverage:

```bash
$ skytest --coverage math_test.star
PASS  test_add

Results: 1 passed, 0 failed
skytest: coverage written to coverage.json

$ skycov coverage.json
Coverage Report
===============
Total: 100.0% (3/3 lines)
```

## Coverage Data

The coverage JSON contains line-level hit counts:

```json
{
  "files": {
    "math_test.star": {
      "lines": {
        "1": 1,
        "2": 3,
        "4": 1,
        "5": 2,
        "6": 2
      }
    }
  },
  "totalLines": 5,
  "coveredLines": 5,
  "percentage": 100
}
```

## Coverage Types

| Type | Status | Description |
|------|--------|-------------|
| Line coverage | âœ… Full | Which lines were executed |
| Statement coverage | âœ… Full | Which statements were executed |
| Function coverage | âš ï¸ Basic | Inferred from line hits |
| Branch coverage | ğŸ”œ Planned | Which branches were taken |

## Next Steps

- [Output Formats](/sky/coverage/output-formats/) - Cobertura, LCOV, JSON
- [CI Integration](/sky/coverage/ci-integration/) - GitHub Actions, GitLab CI
