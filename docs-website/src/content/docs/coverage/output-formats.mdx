---
title: Coverage Output Formats
description: Detailed guide to all coverage output formats - Text, JSON, Cobertura, LCOV, and HTML
---

import { Tabs, TabItem, Aside, Card, CardGrid } from '@astrojs/starlight/components';

# Output Formats

Skytest supports five coverage output formats. The format is automatically selected based on the output file extension.

## Format Summary

| Extension | Format | Use Case | Tools |
|-----------|--------|----------|-------|
| `.txt` | Text | Terminal, quick inspection | Human readable |
| `.json` | JSON | Custom tooling, APIs | jq, scripts |
| `.xml` | Cobertura | CI systems | Jenkins, GitLab, Azure |
| `.lcov` | LCOV | IDE extensions | VS Code, genhtml |
| `.html` | HTML | Browser viewing | Self-contained |

---

## Text Format

Human-readable summary for terminal output.

```toml title="sky.toml"
[test.coverage]
enabled = true
output = "coverage.txt"
```

### Output Example

```txt
Coverage Report
===============

src/parser.star                                              87.5% (14/16 lines)
  Missing: 23-24
src/lexer.star                                               100.0% (12/12 lines)
src/utils.star                                               66.7% (8/12 lines)
  Missing: 5, 18-20

Total: 85.0% (34/40 lines)
```

### Features

- Per-file coverage percentage
- Line counts (covered/total)
- Missing line numbers displayed as ranges
- Aggregate total at bottom

### When to Use

- Quick terminal inspection
- Commit hooks
- Local development feedback

---

## JSON Format

Machine-readable format for programmatic access.

```toml title="sky.toml"
[test.coverage]
enabled = true
output = "coverage.json"
```

### Output Example

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "total_lines": 40,
  "covered_lines": 34,
  "percentage": 85.0,
  "files": [
    {
      "path": "src/parser.star",
      "total_lines": 16,
      "covered_lines": 14,
      "percentage": 87.5,
      "missing_lines": [23, 24]
    },
    {
      "path": "src/lexer.star",
      "total_lines": 12,
      "covered_lines": 12,
      "percentage": 100.0
    },
    {
      "path": "src/utils.star",
      "total_lines": 12,
      "covered_lines": 8,
      "percentage": 66.67,
      "missing_lines": [5, 18, 19, 20]
    }
  ]
}
```

### Schema Reference

| Field | Type | Description |
|-------|------|-------------|
| `timestamp` | string | ISO 8601 timestamp |
| `total_lines` | int | Total executable lines |
| `covered_lines` | int | Lines executed at least once |
| `percentage` | float | Coverage percentage (0-100) |
| `files` | array | Per-file coverage data |
| `files[].path` | string | File path |
| `files[].missing_lines` | array | Line numbers not covered |

### Processing with jq

```bash
# Get overall percentage
jq '.percentage' coverage.json

# List files below 80% coverage
jq '.files[] | select(.percentage < 80) | .path' coverage.json

# Get missing lines for a file
jq '.files[] | select(.path == "src/utils.star") | .missing_lines' coverage.json
```

### When to Use

- Custom dashboards
- Coverage trend analysis
- Integration with internal tools

---

## Cobertura XML Format

Standard format supported by most CI platforms.

```toml title="sky.toml"
[test.coverage]
enabled = true
output = "coverage.xml"
```

### Supported Platforms

<CardGrid>
  <Card title="Jenkins" icon="setting">
    Cobertura plugin provides coverage reports and trends
  </Card>
  <Card title="GitLab CI" icon="rocket">
    Built-in coverage visualization in merge requests
  </Card>
  <Card title="Azure DevOps" icon="document">
    PublishCodeCoverageResults task
  </Card>
  <Card title="Codecov" icon="external">
    Full Cobertura format support
  </Card>
</CardGrid>

### Output Example

```xml
<?xml version="1.0" encoding="UTF-8"?>
<coverage line-rate="0.8500" branch-rate="0" version="1.0" timestamp="1705312200"
          lines-valid="40" lines-covered="34">
  <sources>
    <source>.</source>
  </sources>
  <packages>
    <package name="src" line-rate="0.8500" branch-rate="0" complexity="0">
      <classes>
        <class name="parser.star" filename="src/parser.star" line-rate="0.8750"
               branch-rate="0" complexity="0">
          <lines>
            <line number="1" hits="1"/>
            <line number="2" hits="3"/>
            <line number="10" hits="5"/>
            <line number="23" hits="0"/>
            <line number="24" hits="0"/>
          </lines>
        </class>
        <class name="lexer.star" filename="src/lexer.star" line-rate="1.0000"
               branch-rate="0" complexity="0">
          <lines>
            <line number="1" hits="2"/>
            <line number="2" hits="2"/>
          </lines>
        </class>
      </classes>
    </package>
  </packages>
</coverage>
```

### XML Element Reference

| Element | Attribute | Description |
|---------|-----------|-------------|
| `coverage` | `line-rate` | Overall coverage (0.0-1.0) |
| `coverage` | `lines-valid` | Total executable lines |
| `coverage` | `lines-covered` | Covered lines |
| `package` | `name` | Directory/package name |
| `class` | `filename` | Source file path |
| `line` | `number` | Line number (1-based) |
| `line` | `hits` | Execution count |

### When to Use

- Jenkins with Cobertura plugin
- GitLab CI coverage reports
- Azure DevOps pipelines
- Any CI requiring XML coverage

---

## LCOV Format

Tracefile format compatible with genhtml and IDE extensions.

```toml title="sky.toml"
[test.coverage]
enabled = true
output = "coverage.lcov"
```

### Supported Tools

<CardGrid>
  <Card title="VS Code" icon="laptop">
    Coverage Gutters extension shows inline coverage
  </Card>
  <Card title="JetBrains" icon="laptop">
    Built-in coverage visualization
  </Card>
  <Card title="genhtml" icon="document">
    Generate HTML reports from LCOV
  </Card>
  <Card title="SonarQube" icon="setting">
    Import LCOV for analysis
  </Card>
</CardGrid>

### Output Example

```
TN:
SF:src/parser.star
FN:10,parse_expression
FNDA:5,parse_expression
FN:25,parse_statement
FNDA:3,parse_statement
FNF:2
FNH:2
DA:1,1
DA:2,3
DA:10,5
DA:11,5
DA:23,0
DA:24,0
LF:16
LH:14
end_of_record
TN:
SF:src/lexer.star
DA:1,2
DA:2,2
DA:3,2
LF:12
LH:12
end_of_record
```

### Field Reference

| Field | Format | Description |
|-------|--------|-------------|
| `TN:` | `TN:<name>` | Test name (usually empty) |
| `SF:` | `SF:<path>` | Source file path |
| `FN:` | `FN:<line>,<name>` | Function definition: start line and name |
| `FNDA:` | `FNDA:<hits>,<name>` | Function hit data: call count and name |
| `FNF:` | `FNF:<count>` | Functions found (total) |
| `FNH:` | `FNH:<count>` | Functions hit (covered) |
| `DA:` | `DA:<line>,<hits>` | Line data: line number and hit count |
| `LF:` | `LF:<count>` | Lines found (total) |
| `LH:` | `LH:<count>` | Lines hit (covered) |
| `end_of_record` | - | End of file record |

### Generate HTML with genhtml

```bash
# Generate LCOV
skytest --coverage --coverage-output=coverage.lcov tests/

# Convert to HTML
genhtml coverage.lcov --output-directory coverage-html

# Open in browser
open coverage-html/index.html
```

<Tabs>
  <TabItem label="macOS">
```bash
brew install lcov
```
  </TabItem>
  <TabItem label="Ubuntu/Debian">
```bash
apt-get install lcov
```
  </TabItem>
  <TabItem label="Fedora">
```bash
dnf install lcov
```
  </TabItem>
</Tabs>

### When to Use

- IDE coverage visualization
- VS Code Coverage Gutters
- JetBrains coverage
- Generating detailed HTML with genhtml

---

## HTML Format

Self-contained HTML report with embedded CSS. No external dependencies.

```toml title="sky.toml"
[test.coverage]
enabled = true
output = "coverage.html"
```

### Features

- **Dark theme** - Easy on the eyes
- **Collapsible files** - Click to expand/collapse per-file details
- **Color-coded badges**:
  - üü¢ Green: ‚â•80% coverage
  - üü° Yellow: 50-79% coverage
  - üî¥ Red: <50% coverage
- **Per-line hit counts** - See exactly how many times each line ran
- **No external dependencies** - Single file, works offline

### Output Preview

The HTML report includes:

1. **Summary section** - Overall percentage, covered/total lines, file count
2. **Progress bar** - Visual coverage indicator
3. **File list** - Each file with coverage badge
4. **Line details** - Expand any file to see line-by-line coverage

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Coverage Report                                ‚îÇ
‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê                                ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë  85.0%    34 Lines   3 Files  ‚îÇ
‚îÇ                    Covered                      ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ src/parser.star          14/16   87.5%  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚ñº (click to expand)                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   1  ‚îÇ 1x ‚îÇ def parse():                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   2  ‚îÇ 3x ‚îÇ     token = next()          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  23  ‚îÇ 0x ‚îÇ     return error  ‚Üê RED     ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ src/lexer.star           12/12  100.0%  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Usage

```bash
# Generate HTML report
skytest --coverage --coverage-output=coverage.html tests/

# Open in browser
open coverage.html
```

### When to Use

- Sharing coverage with team
- Local development review
- Offline viewing
- No external tool dependencies needed

---

## Merging Coverage Reports

Combine coverage from multiple test runs:

```bash
# Run different test suites
skytest --coverage --coverage-output=unit.lcov tests/unit/
skytest --coverage --coverage-output=integration.lcov tests/integration/

# Merge with lcov
lcov -a unit.lcov -a integration.lcov -o combined.lcov

# Generate combined report
genhtml combined.lcov -o coverage-html/
```

<Aside type="note">
Merging combines hit counts, so a line hit once in unit tests and twice in integration tests shows 3 total hits.
</Aside>

---

## Format Comparison

| Feature | Text | JSON | Cobertura | LCOV | HTML |
|---------|------|------|-----------|------|------|
| Human readable | ‚úÖ | ‚ùå | ‚ùå | ‚ùå | ‚úÖ |
| Machine parseable | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| CI integration | ‚ùå | ‚ö†Ô∏è | ‚úÖ | ‚ö†Ô∏è | ‚ùå |
| IDE support | ‚ùå | ‚ùå | ‚ùå | ‚úÖ | ‚ùå |
| Self-contained | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Function coverage | ‚ùå | ‚ùå | ‚ùå | ‚úÖ | ‚ùå |
| Hit counts | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |
