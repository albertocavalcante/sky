# golangci-lint configuration (v2)
# https://golangci-lint.run/usage/configuration/

version = "2"

[run]
timeout = "5m"
modules-download-mode = "readonly"

[linters]
# Use standard preset which includes most common linters
default = "standard"

[linters.settings.errcheck]
check-type-assertions = false
check-blank = false

[linters.settings.govet]
enable-all = true
disable = ["shadow", "fieldalignment"]

[linters.settings.staticcheck]
# Disable style suggestions (ST*) and some simplifications (S*, QF*)
checks = ["all", "-ST1023", "-S1009", "-QF*"]

[linters.exclusions]
paths = [
  "bazel-.*",
  "vendor",
]
presets = [
  "comments",
  "std-error-handling",
  "common-false-positives",
]

[[linters.exclusions.rules]]
path = "_test\\.go"
linters = ["funlen", "unused"]

[[linters.exclusions.rules]]
path = "\\.pb\\.go"
linters = ["all"]

# Allow deprecated starlark APIs (we'll update later)
[[linters.exclusions.rules]]
text = "SA1019.*starlark"
linters = ["staticcheck"]

# Allow deprecated syntax APIs
[[linters.exclusions.rules]]
text = "SA1019.*syntax"
linters = ["staticcheck"]

# Exclude all SA1019 deprecation warnings (can address later)
[[linters.exclusions.rules]]
text = "SA1019"
linters = ["staticcheck"]

# Exclude SA5011 nil pointer suggestions in tests
[[linters.exclusions.rules]]
path = "_test\\.go"
text = "SA5011"
linters = ["staticcheck"]

[issues]
max-issues-per-linter = 50
max-same-issues = 10
